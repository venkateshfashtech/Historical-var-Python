import pandas as pd, os, pandas_datareader.data as web,datetime as dt  # sentdex youtube

os.chdir("C:\Users\XBBL36T\Downloads\New folder\BBH")

start = dt.datetime(2000,1,1)
end = dt.datetime(2018,10,31)


df = web.DataReader('TSLA','yahoo',start,end)	#to download price timeseries from web Tsla- ticker,yahoo-source
print(df.head())				#to show the headers along with first few rows while running,adj close after stock split etc
print(df.head(6))				#to show the headers along with first six rows while running
print(df.tail())				#to show the headers along with bottom six rows while running

df.to_csv('PriceTimeSeries -Tesla.csv')
df = pd.read_csv('PriceTimeSeries-Tesla.csv',parse_dates=True, index_col='Date')

percent = df[['Adj Close']].pct_change()*100
percent.sort_values(by=['Return'],ascending=True,na_position='first')
percent.dropna()
row_count =len(percent)
position = int((5*row_count)*100)
Pnl =df.loc['end'] * percent.iloc[[position+1]]
Print("Historical PnL :{}.format(pnl))


writer = pd.ExcelWriter('Historical Var-Tesla.xlsx',engine='xlsxwriter')
df.to_excel(writer, sheet_name='Sheet1')
percent.to_excel(writer, sheet_name='Sheet1', startcol=6, startrow=1)
pnl_text = "PnL for Tesla"
Pnl_text.to_excel(writer, sheet_name='Sheet1', startcol=8, startrow=4)
Pnl.to_excel(writer, sheet_name='Sheet1', startcol=8, startrow=5)
writer.save()


